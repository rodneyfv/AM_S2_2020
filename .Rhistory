boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo")
# Boxplots
par(mfrow=c(2,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
# Boxplots
par(mfrow=c(2,2),mar=c(2,2,2,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
# Boxplots
par(mfrow=c(2,2),mar=c(1,1,1,1))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(3,3,3,3))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(3,5,3,3))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(3,4,3,3))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
# Boxplots
par(mfrow=c(2,2),mar=c(3,4,3,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
# Boxplots
par(mfrow=c(2,2),mar=c(3,4,4,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(2,4,3,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(4,4,3,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
# Boxplots
par(mfrow=c(2,2),mar=c(4,4,2,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
par(mfrow=c(4,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variavel:",j," e  grupo:",i)))
}
}
par(mfrow=c(4,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável:",j," e  grupo:",i)))
}
}
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo",i)))
}
}
par(mfrow=c(4,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="",
main=paste("variavel:",j," e  grupo:",i)))
}
}
par(mfrow=c(4,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="",
main=paste("variável",j," e  grupo",i)))
}
}
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
qqPlot(n2*vQg2,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 1")
par(mfrow=c(2,1),mar=c(2,2,2,2))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
qqPlot(n2*vQg2,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 2")
par(mfrow=c(2,1),mar=c(3,3,3,3))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
par(mfrow=c(2,1),mar=c(4,4,2,2))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
qqPlot(n2*vQg2,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da forma quadrática",main="grupo 2")
par(mfrow=c(2,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 1")))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 1")))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 1"),
xlab = "nota", ylab = "frequência"))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 2"),
xlab = "nota", ylab = "frequência"))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 1"),
xlab = "nota", ylab = "frequência"))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 2"),
xlab = "nota", ylab = "frequência"))
}
dados %>% filter(group == 2) %>% plot()
dados %>% filter(group == 2) %>% select(L,R,S,W) %>% plot()
dados %>% filter(group == 2) %>% select(L,R,S,W) %>% plot(main="grupo 1")
dados %>% filter(group == 1) %>% select(L,R,S,W) %>% plot(main="grupo 1")
dados %>% filter(group == 2) %>% select(L,R,S,W) %>% plot(main="grupo 2")
par(mfrow=c(4,2),mar=c(2,2,2,2))
for(j in c("L","R","S","W")){
for(i in 1:2){
dados %>% filter(group == i) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="",
main=paste("variável",j," e  grupo",i)))
}
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="",
main=paste("variável",j," e  grupo 1")))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="quantil da distribuição da variável",
main=paste("variável",j," e  grupo 1")))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="quantil da distribuição da variável",
main=paste("variável",j," e  grupo 2")))
}
par(mfrow=c(2,1),mar=c(4,4,2,2))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da dist. da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
qqPlot(n2*vQg2,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da dist. da quadrática",main="grupo 2")
n1
n2
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(min = min(col), max=max(col), media=mean(col), sd=sd(col)) %>%
print.table()
}
cat("---------\n")
}
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(media=mean(col), sd=sd(col), var=var(col),
min = min(col), mediana = median(col), max=max(col)) %>%
print.table()
}
cat("---------\n")
}
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(media=round(mean(col),2), sd=round(sd(col),2),
var=round(var(col),4), min = min(col),
mediana = median(col), max=max(col)) %>%
print.table()
}
cat("---------\n")
}
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(media=round(mean(col),2), sd=round(sd(col),2),
var=round(var(col),4), min = min(col),
mediana = median(col), max=max(col)) %>%
print.table(sep = " & ")
}
cat("---------\n")
}
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(media=round(mean(col),2), sd=round(sd(col),2),
var=round(var(col),4), min = min(col),
mediana = median(col), max=max(col), n=n()) %>%
print.table()
}
cat("---------\n")
}
par(mfrow=c(2,1),mar=c(4,4,2,2))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
s2g1
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor()
?cor
?cov
?cov
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% round(2) %>% cor()
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
round(s2g1,2)
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
round(s2g2,2)
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
# bibliotecas necessárias
library(car)
library(tidyverse)
# lendo os dados
practice_delay <- read.table("./Dados/practice_delay.dat",header = TRUE)
View(practice_delay)
dados <- as.data.frame(practice_delay)
head(dados)
# número de variáveis
p <- 4
# tamanhos amostrais em cada grupo
n1 <- dados %>% filter(group==1) %>% count() %>% as.numeric()
n2 <- dados %>% filter(group==2) %>% count() %>% as.numeric()
for(i in 1:2){
cat("Grupo: ",i,"\n")
for(j in c("L","R","S","W")){
cat("variável: ",j,"\n")
dados %>% filter(group == i) %>% mutate_(col=j) %>%
summarise(media=round(mean(col),2), sd=round(sd(col),2),
var=round(var(col),4), min = min(col),
mediana = median(col), max=max(col), n=n()) %>%
print.table()
}
cat("---------\n")
}
# Boxplots
par(mfrow=c(2,2),mar=c(4,4,2,2))
boxplot(dados$L~dados$group,ylab = "nota", xlab = "grupo", main = "variável: L")
boxplot(dados$R~dados$group,ylab = "nota", xlab = "grupo", main = "variável: R")
boxplot(dados$S~dados$group,ylab = "nota", xlab = "grupo", main = "variável: S")
boxplot(dados$W~dados$group,ylab = "nota", xlab = "grupo", main = "variável: W")
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 1"),
xlab = "nota", ylab = "frequência"))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
with(hist(col,main=paste("variável",j," e  grupo 2"),
xlab = "nota", ylab = "frequência"))
}
dados %>% filter(group == 1) %>% select(L,R,S,W) %>% plot(main="grupo 1")
dados %>% filter(group == 2) %>% select(L,R,S,W) %>% plot(main="grupo 2")
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="quantil da distribuição da variável",
main=paste("variável",j," e  grupo 1")))
}
par(mfrow=c(2,2),mar=c(4,4,2,2))
for(j in c("L","R","S","W")){
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
with(qqPlot(scale(col),dist="norm",mean=0,
sd=1,col.lines=1,grid="FALSE",
xlab="quantil da N(0,1)",ylab="quantil da distribuição da variável",
main=paste("variável",j," e  grupo 2")))
}
par(mfrow=c(2,1),mar=c(4,4,2,2))
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
round(s2g1,2)
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
qqPlot(n1*vQg1,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da dist. da forma quadrática",main="grupo 1")
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
round(s2g2,2)
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
qqPlot(n2*vQg2,dist="chisq",df=p,col.lines=1,grid="FALSE",
xlab="quantil da distribuição qui-quadrado",
ylab="quantil da dist. da quadrática",main="grupo 2")
n = n1 + n2  # tamanho amostral
source("./MANOVA_Multivariada_ME_731_2S_2020.R")
source("./Diag Multivariate Linear Models ME 731 2S 2020.R", encoding = "windows-1252")
# vetor com o grupo referente a cada linha dos dados
v.grupos <- cbind(as.numeric(dados$group))
v.n<-rbind(n1,n2) # vetor de tamanhos amostrais
G<-2  # número de grupo
p<-4  # número de variáveis
# Teste de iguldade das matrizes de covariância
m.Sigma.P<-Box.teste.Igual.MCov(dados[,1:4],v.grupos,v.n,G)$Sigma.P
# Teste de iguldade das matrizes de covariância
m.Sigma.P<-Box.teste.Igual.MCov(dados[,1:4],v.grupos,v.n,G)$Sigma.P
# Comparação dos vetores de médias
fit.model<-m.ajuste <- manova(as.matrix(dados[,1:4]) ~ dados$group)
summary.manova(m.ajuste,test="Wilks")
summary.manova(m.ajuste,test="Pillai")
summary.manova(m.ajuste,test="Hotelling-Lawley")
summary.manova(m.ajuste,test="Roy")
# estatística de teste na equação 6.27
# do livro Johnson e Wichern (2007, 6 ed, p. 294)
T2 <- t(mug1 - mug2)%*%solve((1/n1)*s2g1 + (1/n2)*s2g2)%*%(mug1 - mug2)
# função para calcular o traço de uma matriz quadrada
tr <- function(x){ sum(diag(x)) }
# calculando os graus de liberdade fornecidos na equação 6.28
# do livro Johnson e Wichern (2007, 6 ed, p. 294)
tmp1 <- (1/n1)*s2g1%*%solve((1/n1)*s2g1 + (1/n2)*s2g2)
tmp2 <- (1/n2)*s2g2%*%solve((1/n1)*s2g1 + (1/n2)*s2g2)
nu <- (p + p^2)/(
(1/n1)*(tr(tmp1%*%tmp1) + (tr(tmp1))^2) +
(1/n2)*(tr(tmp2%*%tmp2) + (tr(tmp2))^2)
)
# a condição abaixo em nu deve ser verdadeira
(min(n1,n2)<nu)&(nu<(n1+n2))
# valor crítico para a estatística de teste ao nível de 5%
# de significância
(nu*p/(nu - p + 1))*qf(.05,p,nu-p+1,lower.tail = FALSE)
# não rejeitamos H0 ao nível de 5% de significância
T2 > (nu*p/(nu - p + 1))*qf(.05,p,nu-p+1,lower.tail = FALSE)
pf(T2/(nu*p/(nu - p + 1)),p,nu-p+1,lower.tail = FALSE)
# valor crítico para a estatística de teste ao nível de 5%
# de significância
(nu*p/(nu - p + 1))*qf(.05,p,nu-p+1,lower.tail = FALSE)
# não rejeitamos H0 ao nível de 5% de significância
T2 > (nu*p/(nu - p + 1))*qf(.05,p,nu-p+1,lower.tail = FALSE)
T2
# bibliotecas necessárias
library(car)
library(tidyverse)
# lendo os dados
practice_delay <- read.table("./Dados/practice_delay.dat",header = TRUE)
View(practice_delay)
dados <- as.data.frame(practice_delay)
head(dados)
# número de variáveis
p <- 4
# tamanhos amostrais em cada grupo
n1 <- dados %>% filter(group==1) %>% count() %>% as.numeric()
n2 <- dados %>% filter(group==2) %>% count() %>% as.numeric()
s2g1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
round(s2g1,2)
dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
mug1 <- dados %>% filter(group == 1) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg1 <- dados %>% filter(group == 1) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug1,cov=s2g1)
s2g2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cov()
round(s2g2,2)
dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% cor() %>% round(2)
mug2 <- dados %>% filter(group == 2) %>% mutate_(col=j) %>%
select(c(L,R,S,W)) %>% colMeans()
vQg2 <- dados %>% filter(group == 2) %>% select(c(L,R,S,W)) %>%
mahalanobis(center=mug2,cov=s2g2)
n = n1 + n2  # tamanho amostral
# vetor com o grupo referente a cada linha dos dados
v.grupos <- cbind(as.numeric(dados$group))
v.n<-rbind(n1,n2) # vetor de tamanhos amostrais
G<-2  # número de grupo
p<-4  # número de variáveis
# Teste de iguldade das matrizes de covariância
m.Sigma.P<-Box.teste.Igual.MCov(dados[,1:4],v.grupos,v.n,G)$Sigma.P
# Comparação dos vetores de médias
fit.model<-m.ajuste <- manova(as.matrix(dados[,1:4]) ~ dados$group)
summary.manova(m.ajuste,test="Wilks")
summary.manova(m.ajuste,test="Pillai")
summary.manova(m.ajuste,test="Hotelling-Lawley")
summary.manova(m.ajuste,test="Roy")
# não rejeitamos H0 ao nível de 5% de significância
T2 > (nu*p/(nu - p + 1))*qf(.05,p,nu-p+1,lower.tail = FALSE)
T2
# nível descritivo
pf(T2/(nu*p/(nu - p + 1)),p,nu-p+1,lower.tail = FALSE)
